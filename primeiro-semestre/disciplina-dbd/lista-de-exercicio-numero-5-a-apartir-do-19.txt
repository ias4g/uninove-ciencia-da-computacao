-- RESOLUÃ‡ÃƒO DOS EXERCICIOS DA LISTA DE NÃšMERO 5, A PARTIR DO 19Âº

-- ###############################################################################
--  SELECT      LISTA DE CAMPOS PARA PROJEÃ‡ÃƒO
--  FROM        NOME DA TABELA
--  WHERE       CONDICIONAL PARA FILTRAR LINHAS DA TABELA
--  GROUP BY    AGRUPA AS LINHAS RESULTANTES
--  HAVING      CONDICIONAL PARA FILTRAR LINHAS APOS AGRUPAR
--  ORDER BY    ORDENA/CLASSIFICA AS LINHAS RESULTANTES
-- ###############################################################################

-- 19) Consulte o campo DEPTNO da tabela EMP, alterando o cabeÃ§alho para â€˜NÃºmero do
-- departamentoâ€™, alÃ©m de apresentar o menor salÃ¡rio, maior salÃ¡rio, mÃ©dia salarial por
-- departamento. Para isso, agrupe pelo nÃºmero do departamento.
-- RESPOSTA 19 ðŸ‘‡
    SELECT DEPTNO AS "NÃšMERO DO DEPARTAMENTO",
    MIN(SAL),
    MAX(SAL)
    FROM emp
    GROUP BY DEPTNO
    
    
-- 20) Consulte o nome dos empregados, seu cargo, data de admissÃ£o, alÃ©m de apresentar
-- quantas semanas existem entre a data de hoje e data em que foram admitidos. Coloque
-- um apelido para a Ãºltima coluna como â€œSemanasâ€.
-- RESPOSTA 20 ðŸ‘‡
    SELECT ENAME, JOB, HIREDATE, (SYSDATE-HIREDATE) AS SEMANAS
    FROM EMP
    

-- 21) Crie uma cÃ³pia da tabela ALUNO (com todos os campos da tabela), chamada
-- COPIAALUNO. Utilize para isso o comando SELECT. Apague esta tabela logo em
-- seguida.
-- RESPOSTA 21 ðŸ‘‡
    CREATE
    TABLE COPIALUNO
    AS
    SELECT * FROM ALUNO
    
    
-- 22) Consulte a quantidade de funcionÃ¡rios por departamento da tabela EMP.
-- RESPOSTA 22 ðŸ‘‡
    SELECT DEPTNO, COUNT(*) AS QTD_ALUNOS
    FROM EMP
    GROUP BY DEPTNO
    

-- 23) Qual o custo dos empregados por departamento?
-- RESPOSTA 23 ðŸ‘‡
    SELECT DEPTNO, SUM(SAL)
    FROM EMP
    GROUP BY DEPTNO


-- 24) FaÃ§a uma consulta que apresente todos os alunos matriculados no perÃ­odo de 15/03/08 a
-- 30/04/08, mostrando apenas seu CÃ³digo, Nome e Data de Nascimento, classificados por
-- Nome. Altere os cabeÃ§alhos para CÃ³d.Aluno, Nome Aluno e Data Nasc, respectivamente.
-- RESPOSTA 24 ðŸ‘‡
    SELECT IDALUNO AS "CODIGO ALUNO", NOME AS "NOME DO ALUNO", DTNASC AS "DATA DE NASCIMENTO"
    FROM ALUNO
    WHERE DTMATRIC BETWEEN '15/03/08' AND '30/04/08'
    ORDER BY NOME
    
    
-- 25) O aluno Mauro Soares fez o pagamento referente ao mÃªs de Novembro no dia 16/10/08 no
-- valor de R$ 260,00. Seu professor Ã© o Gerson Almeida e o cÃ³digo do registro do
-- pagamento Ã© 78400. Escreva o comando para cadastrar essa informaÃ§Ã£o na tabela PAGTO.
-- RESPOSTA 25 ðŸ‘‡
    INSERT INTO PAGTO (IDPAGTO, IDALUNO, DTPAGTO, VALLIQ, IDPROF)
    VALUES (78400, 10443, '10-16-2008', 260.00, 'GA')
    

-- 26) FaÃ§a uma consulta que traga todos os pagamentos da aluna Paola Moraes, mostrando
-- apenas as colunas correspondentes ao cÃ³digo do professor, data do pagamento e valor,
-- apresentando os cabeÃ§alhos Professor, Data Pagto e Valor Pago, respectivamente.
-- RESPOSTA 26 ðŸ‘‡
    SELECT IDPROF AS PROFESSOR, DTPAGTO AS "DATA DO PGAMENTO", VALLIQ AS "VALOR DO PAGAMENTO"
    FROM PAGTO
    WHERE IDALUNO = 10468


-- 27)O aluno Pedro Santos saiu da academia e seu registro deve ser eliminado da tabela
-- ALUNO. Para que isso ocorra Ã© necessÃ¡rio excluir primeiro os registros de pagamentos
-- desse aluno. Escreva o comando para executar a aÃ§Ã£o solicitada referente aos registros de
-- pagamentos da tabela PAGTO.
-- RESPOSTA 27 ðŸ‘‡
    DELETE
    FROM PAGTO
    WHERE IDALUNO = 10468


-- 28)SerÃ¡ necessÃ¡rio adicionar uma nova coluna na tabela ALUNO para guardar o CPF, que deve
-- ser do tipo VARCHAR(15). Essa coluna deverÃ¡ conter uma restriÃ§Ã£o para nÃ£o permitir
-- valores duplicados. Escreva o comando necessÃ¡rio para execuÃ§Ã£o dessa tarefa.
-- RESPOSTA 28 ðŸ‘‡
    ALTER
    TABLE ALUNO
    ADD (CPF VARCHAR2(15) CONSTRAINT ALUNO_CPF_UU UNIQUE) 


-- 29)A data de nascimento do aluno Carlos Lins estÃ¡ incorreta. No cadastro consta 12/11/1977
-- quando na realidade Ã© 10/11/1977. Escreva o comando para corrigir esse dado na tabela
-- ALUNO.
-- RESPOSTA 24 ðŸ‘‡
    UPDATE ALUNO
    SET DTNASC = TO_DATE('10/11/77', 'DD/MM/YY')
    WHERE IDALUNO = 10194


-- 30)Os registros de pagamentos do aluno Pedro Santos foram eliminados, conforme solicitado
-- no exercÃ­cio 27, porÃ©m, houve uma confusÃ£o com relaÃ§Ã£o ao nome do aluno. O aluno que
-- saiu da academia foi o Roberto Santos e nÃ£o o Pedro Santos. Com o objetivo de retornar a
-- situaÃ§Ã£o anterior Ã  exclusÃ£o digite o comando abaixo:
-- ROLLBACK;
-- RESPOSTA 30 ðŸ‘‡
    ROLLBACK


-- 31)Verifique o que aconteceu com as operaÃ§Ãµes efetuadas nos exercÃ­cios nos 27, 28 e 29 e
-- entenda o porque.
-- RESPOSTA 31 ðŸ‘‡


-- 32)FaÃ§a uma consulta que apresente o total pago por alunos no ano de 2007 e a mÃ©dia de
-- valores pagos por eles
-- RESPOSTA 32 ðŸ‘‡
    SELECT      IDALUNO, SUM(VALLIQ), AVG(VALLIQ)
    FROM        PAGTO
    WHERE       DTPAGO LIKE '__/__/07'
    GROUP BY    IDALUNO
    
    -- OU
    
    SELECT      IDALUNO, SUM(VALLIQ), AVG(VALLIQ)
    FROM        PAGTO
    WHERE       DTPAGO LIKE '%07'
    GROUP BY    IDALUNO
    
    -- OU
    
    SELECT      IDALUNO, SUM(VALLIQ), AVG(VALLIQ)
    FROM        PAGTO
    WHERE       DTPAGO BETWEEN '01/01/2007' AND '31/12/2007'
    GROUP BY    IDALUNO
    
    -- OU
    
    SELECT      IDALUNO, SUM(VALLIQ), AVG(VALLIQ)
    FROM        PAGTO
    WHERE       DTPAGO >= '01/01/2007' AND DTPAGO <= '31/12/2007'
    GROUP BY    IDALUNO


-- 33)Consulte quantos pagamentos foram feitos para cada professor no 1Âº semestre de 2008,
-- classificando por professor.
-- RESPOSTA 33 ðŸ‘‡
    SELECT      IDPROF, COUNT(*)
    FROM        PAGTO
    WHERE       DTPAGTO BETWEEN '01/01/2008' AND '30/06/2008'
    GROUP BY    IDPROF
    ORDER BY    IDPROF
    
    