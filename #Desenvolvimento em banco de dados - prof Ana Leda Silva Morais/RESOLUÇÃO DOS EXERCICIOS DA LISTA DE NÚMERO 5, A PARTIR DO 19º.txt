-- RESOLU√á√ÉO DOS EXERCICIOS DA LISTA DE N√öMERO 5, A PARTIR DO 19¬∫

-- 19) Consulte o campo DEPTNO da tabela EMP, alterando o cabe√ßalho para ‚ÄòN√∫mero do
-- departamento‚Äô, al√©m de apresentar o menor sal√°rio, maior sal√°rio, m√©dia salarial por
-- departamento. Para isso, agrupe pelo n√∫mero do departamento.
-- RESPOSTA 19 üëá
    SELECT DEPTNO AS "N√öMERO DO DEPARTAMENTO",
    MIN(SAL),
    MAX(SAL)
    FROM emp
    GROUP BY DEPTNO
    
    
-- 20) Consulte o nome dos empregados, seu cargo, data de admiss√£o, al√©m de apresentar
-- quantas semanas existem entre a data de hoje e data em que foram admitidos. Coloque
-- um apelido para a √∫ltima coluna como ‚ÄúSemanas‚Äù.
-- RESPOSTA 20 üëá
    SELECT ENAME, JOB, HIREDATE, (SYSDATE-HIREDATE) AS SEMANAS
    FROM EMP
    

-- 21) Crie uma c√≥pia da tabela ALUNO (com todos os campos da tabela), chamada
-- COPIAALUNO. Utilize para isso o comando SELECT. Apague esta tabela logo em
-- seguida.
-- RESPOSTA 21 üëá
    CREATE
    TABLE COPIALUNO
    AS
    SELECT * FROM ALUNO
    
    
-- 22) Consulte a quantidade de funcion√°rios por departamento da tabela EMP.
-- RESPOSTA 22 üëá
    SELECT DEPTNO, COUNT(*) AS QTD_ALUNOS
    FROM EMP
    GROUP BY DEPTNO
    

-- 23) Qual o custo dos empregados por departamento?
-- RESPOSTA 23 üëá
    SELECT DEPTNO, SUM(SAL)
    FROM EMP
    GROUP BY DEPTNO


-- 24) Fa√ßa uma consulta que apresente todos os alunos matriculados no per√≠odo de 15/03/08 a
-- 30/04/08, mostrando apenas seu C√≥digo, Nome e Data de Nascimento, classificados por
-- Nome. Altere os cabe√ßalhos para C√≥d.Aluno, Nome Aluno e Data Nasc, respectivamente.
-- RESPOSTA 24 üëá
    SELECT IDALUNO AS "CODIGO ALUNO", NOME AS "NOME DO ALUNO", DTNASC AS "DATA DE NASCIMENTO"
    FROM ALUNO
    WHERE DTMATRIC BETWEEN '15/03/08' AND '30/04/08'
    ORDER BY NOME
    
    
-- 25) O aluno Mauro Soares fez o pagamento referente ao m√™s de Novembro no dia 16/10/08 no
-- valor de R$ 260,00. Seu professor √© o Gerson Almeida e o c√≥digo do registro do
-- pagamento √© 78400. Escreva o comando para cadastrar essa informa√ß√£o na tabela PAGTO.
-- RESPOSTA 25 üëá
    INSERT INTO PAGTO (IDPAGTO, IDALUNO, DTPAGTO, VALLIQ, IDPROF)
    VALUES (78400, 10443, '10-16-2008', 260.00, 'GA')
    

-- 26) Fa√ßa uma consulta que traga todos os pagamentos da aluna Paola Moraes, mostrando
-- apenas as colunas correspondentes ao c√≥digo do professor, data do pagamento e valor,
-- apresentando os cabe√ßalhos Professor, Data Pagto e Valor Pago, respectivamente.
-- RESPOSTA 26 üëá
    SELECT IDPROF AS PROFESSOR, DTPAGTO AS "DATA DO PGAMENTO", VALLIQ AS "VALOR DO PAGAMENTO"
    FROM PAGTO
    WHERE IDALUNO = 10468


-- 27)O aluno Pedro Santos saiu da academia e seu registro deve ser eliminado da tabela
-- ALUNO. Para que isso ocorra √© necess√°rio excluir primeiro os registros de pagamentos
-- desse aluno. Escreva o comando para executar a a√ß√£o solicitada referente aos registros de
-- pagamentos da tabela PAGTO.
-- RESPOSTA 27 üëá
    DELETE
    FROM PAGTO
    WHERE IDALUNO = 10468


-- 28)Ser√° necess√°rio adicionar uma nova coluna na tabela ALUNO para guardar o CPF, que deve
-- ser do tipo VARCHAR(15). Essa coluna dever√° conter uma restri√ß√£o para n√£o permitir
-- valores duplicados. Escreva o comando necess√°rio para execu√ß√£o dessa tarefa.
-- RESPOSTA 28 üëá
    ALTER
    TABLE ALUNO
    ADD (CPF VARCHAR2(15) CONSTRAINT ALUNO_CPF_UU UNIQUE) 


-- 29)A data de nascimento do aluno Carlos Lins est√° incorreta. No cadastro consta 12/11/1977
-- quando na realidade √© 10/11/1977. Escreva o comando para corrigir esse dado na tabela
-- ALUNO.
-- RESPOSTA 24 üëá
    UPDATE ALUNO
    SET DTNASC = TO_DATE('10/11/77', 'DD/MM/YY')
    WHERE IDALUNO = 10194


-- 30)Os registros de pagamentos do aluno Pedro Santos foram eliminados, conforme solicitado
-- no exerc√≠cio 27, por√©m, houve uma confus√£o com rela√ß√£o ao nome do aluno. O aluno que
-- saiu da academia foi o Roberto Santos e n√£o o Pedro Santos. Com o objetivo de retornar a
-- situa√ß√£o anterior √† exclus√£o digite o comando abaixo:
-- ROLLBACK;
-- RESPOSTA 30 üëá
    ROLLBACK


-- 31)Verifique o que aconteceu com as opera√ß√µes efetuadas nos exerc√≠cios nos 27, 28 e 29 e
-- entenda o porque.
-- RESPOSTA 31 üëá


-- 32)Fa√ßa uma consulta que apresente o total pago por alunos no ano de 2007 e a m√©dia de
-- valores pagos por eles
-- RESPOSTA 32 üëá


-- 33)Consulte quantos pagamentos foram feitos para cada professor no 1o semestre de 2008,
-- classificando por professor.
-- RESPOSTA 33 üëá
